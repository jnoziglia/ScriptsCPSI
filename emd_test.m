clc; 
close all;
clear;

% Clase 1
archivos_norm = ["A0002" "A0016" "A0020" "A0029" "A0030" "A0037" "A0038" "A0041" "A0059" "A0073" "A0075" "A0089" "A0090" "A0094" "A0107" "A0125" "A0133" "A0141" "A0143" "A0149" "A0157" "A0164" "A0166" "A0170" "A0173" "A0175" "A0176" "A0177" "A0179" "A0189" "A0190" "A0192" "A0193" "A0206" "A0208" "A0210" "A0221" "A0229" "A0233" "A0254" "A0264" "A0281" "A0283" "A0285" "A0287" "A0305" "A0312" "A0315" "A0327" "A0330" "A0332" "A0335" "A0344" "A0348" "A0357" "A0365" "A0371" "A0387" "A0395" "A0419" "A0429" "A0448" "A0453" "A0476" "A0480" "A0481" "A0482" "A0497" "A0505" "A0512" "A0520" "A0526" "A0527" "A0528" "A0534" "A0550" "A0565" "A0567" "A0569" "A0576" "A0579" "A0588" "A0597" "A0614" "A0617" "A0632" "A0634" "A0636" "A0640" "A0644" "A0648" "A0653" "A0665" "A0674" "A0683" "A0690" "A0711" "A0716" "A0721" "A0727" "A0736" "A0753" "A0772" "A0774" "A0785" "A0800" "A0803" "A0805" "A0823" "A0824" "A0827" "A0838" "A0841" "A0843" "A0858" "A0864" "A0891" "A0892" "A0904" "A0911" "A0918" "A0929" "A0951" "A0952" "A0955" "A0968" "A0973" "A0983" "A0985" "A0987" "A0991" "A0998" "A1009" "A1012" "A1015" "A1024" "A1035" "A1042" "A1056" "A1077" "A1082" "A1087" "A1096" "A1097" "A1106" "A1115" "A1121" "A1122" "A1126" "A1129" "A1137" "A1141" "A1144" "A1150" "A1151" "A1166" "A1168" "A1175" "A1176" "A1189" "A1208" "A1220" "A1229" "A1234" "A1241" "A1246" "A1251" "A1257" "A1272" "A1301" "A1327" "A1337" "A1339" "A1349" "A1353" "A1376" "A1381" "A1383" "A1401" "A1419" "A1421" "A1437" "A1447" "A1456" "A1459" "A1463" "A1470" "A1480" "A1484" "A1501" "A1507" "A1508" "A1515" "A1531" "A1534" "A1536" "A1542" "A1555" "A1557" "A1558" "A1561" "A1567" "A1582" "A1599" "A1610" "A1613" "A1616" "A1627" "A1629" "A1630" "A1642" "A1649" "A1655" "A1667" "A1668" "A1672" "A1674" "A1685" "A1692" "A1695" "A1698" "A1699" "A1700" "A1702" "A1714" "A1722" "A1736" "A1766" "A1776" "A1778" "A1806" "A1808" "A1831" "A1857" "A1862" "A1864" "A1869" "A1876" "A1880" "A1891" "A1892" "A1893" "A1914" "A1921" "A1924" "A1928" "A1938" "A1943" "A1949" "A1961" "A1964" "A1971" "A1979" "A1983" "A1993" "A2012" "A2014" "A2022" "A2040" "A2043" "A2046" "A2052" "A2057" "A2060" "A2070" "A2086" "A2089" "A2110" "A2112" "A2125" "A2126" "A2127" "A2131" "A2142" "A2151" "A2154" "A2165" "A2168" "A2170" "A2197" "A2204" "A2205" "A2206" "A2219" "A2225" "A2233" "A2242" "A2246" "A2253" "A2257" "A2261" "A2262" "A2264" "A2273" "A2275" "A2285" "A2301" "A2306" "A2317" "A2337" "A2347" "A2350" "A2370" "A2371" "A2377" "A2380" "A2383" "A2398" "A2401" "A2402" "A2403" "A2419" "A2426" "A2428" "A2433" "A2441" "A2442" "A2454" "A2462" "A2469" "A2473" "A2475" "A2484" "A2493" "A2495" "A2496" "A2498" "A2501" "A2505" "A2507" "A2518" "A2538" "A2543" "A2544" "A2547" "A2549" "A2550" "A2569" "A2570" "A2571" "A2582" "A2583" "A2588" "A2591" "A2600" "A2609" "A2626" "A2660" "A2661" "A2667" "A2675" "A2685" "A2687" "A2700" "A2702" "A2722" "A2730" "A2751" "A2770" "A2773" "A2785" "A2792" "A2796" "A2805" "A2817" "A2820" "A2824" "A2841" "A2842" "A2860" "A2868" "A2891" "A2895" "A2909" "A2911" "A2919" "A2921" "A2923" "A2925" "A2944" "A2945" "A2956" "A2971" "A2976" "A2981" "A2982" "A2986" "A2988" "A2990" "A3023" "A3038" "A3044" "A3068" "A3080" "A3081" "A3085" "A3086" "A3100" "A3128" "A3129" "A3134" "A3137" "A3153" "A3155" "A3157" "A3175" "A3179" "A3186" "A3211" "A3215" "A3217" "A3218" "A3220" "A3221" "A3228" "A3238" "A3239" "A3241" "A3246" "A3250" "A3255" "A3256" "A3261" "A3265" "A3269" "A3272" "A3304" "A3307" "A3311" "A3327" "A3350" "A3351" "A3354" "A3358" "A3363" "A3377" "A3392" "A3394" "A3399" "A3410" "A3413" "A3422" "A3423" "A3424" "A3430" "A3431" "A3435" "A3442" "A3454" "A3465" "A3470" "A3485" "A3498" "A3500" "A3501" "A3503" "A3505" "A3513" "A3529" "A3548" "A3557" "A3569" "A3579" "A3582" "A3586" "A3588" "A3590" "A3600" "A3601" "A3603" "A3608" "A3613" "A3619" "A3625" "A3629" "A3633" "A3643" "A3648" "A3650" "A3651" "A3653" "A3655" "A3657" "A3663" "A3671" "A3680" "A3689" "A3690" "A3713" "A3717" "A3723" "A3732" "A3733" "A3735" "A3739" "A3745" "A3747" "A3751" "A3766" "A3769" "A3776" "A3788" "A3790" "A3791" "A3795" "A3800" "A3806" "A3814" "A3816" "A3818" "A3828" "A3829" "A3832" "A3858" "A3867" "A3869" "A3873" "A3879" "A3886" "A3893" "A3894" "A3898" "A3903" "A3912" "A3920" "A3922" "A3924" "A3925" "A3930" "A3932" "A3947" "A3971" "A3973" "A3975" "A3981" "A3984" "A3987" "A3989" "A3992" "A4007" "A4011" "A4015" "A4019" "A4022" "A4024" "A4032" "A4036" "A4065" "A4066" "A4071" "A4088" "A4093" "A4098" "A4099" "A4102" "A4113" "A4115" "A4146" "A4147" "A4154" "A4160" "A4167" "A4174" "A4176" "A4207" "A4208" "A4209" "A4213" "A4219" "A4228" "A4234" "A4235" "A4237" "A4251" "A4257" "A4262" "A4263" "A4275" "A4284" "A4286" "A4291" "A4299" "A4310" "A4317" "A4327" "A4351" "A4364" "A4366" "A4370" "A4371" "A4374" "A4378" "A4381" "A4396" "A4398" "A4399" "A4401" "A4418" "A4422" "A4429" "A4437" "A4448" "A4451" "A4456" "A4468" "A4474" "A4486" "A4503" "A4504" "A4512" "A4526" "A4532" "A4543" "A4548" "A4550" "A4563" "A4570" "A4571" "A4576" "A4596" "A4597" "A4618" "A4631" "A4644" "A4649" "A4656" "A4660" "A4662" "A4668" "A4678" "A4686" "A4687" "A4702" "A4714" "A4719" "A4737" "A4743" "A4744" "A4751" "A4754" "A4772" "A4781" "A4785" "A4790" "A4791" "A4794" "A4806" "A4808" "A4811" "A4828" "A4832" "A4853" "A4862" "A4867" "A4881" "A4882" "A4883" "A4888" "A4895" "A4910" "A4920" "A4931" "A4940" "A4944" "A4946" "A4947" "A4952" "A4961" "A4963" "A4967" "A4968" "A4973" "A4976" "A4984" "A4994" "A5004" "A5013" "A5046" "A5072" "A5077" "A5094" "A5108" "A5114" "A5125" "A5131" "A5133" "A5137" "A5148" "A5149" "A5155" "A5163" "A5168" "A5175" "A5180" "A5183" "A5194" "A5201" "A5207" "A5223" "A5229" "A5237" "A5239" "A5241" "A5244" "A5248" "A5253" "A5266" "A5268" "A5286" "A5297" "A5322" "A5373" "A5386" "A5387" "A5389" "A5405" "A5422" "A5427" "A5428" "A5429" "A5437" "A5449" "A5452" "A5465" "A5470" "A5477" "A5481" "A5482" "A5486" "A5493" "A5498" "A5499" "A5509" "A5516" "A5566" "A5572" "A5579" "A5586" "A5594" "A5600" "A5602" "A5603" "A5616" "A5620" "A5635" "A5636" "A5644" "A5667" "A5675" "A5687" "A5693" "A5694" "A5697" "A5704" "A5712" "A5713" "A5714" "A5716" "A5727" "A5732" "A5735" "A5737" "A5741" "A5763" "A5765" "A5779" "A5785" "A5802" "A5809" "A5827" "A5838" "A5859" "A5861" "A5866" "A5883" "A5891" "A5905" "A5906" "A5913" "A5916" "A5933" "A5934" "A5937" "A5940" "A5941" "A5944" "A5950" "A5955" "A5959" "A5970" "A5976" "A5984" "A5986" "A5991" "A5992" "A6012" "A6016" "A6020" "A6021" "A6026" "A6030" "A6042" "A6046" "A6064" "A6066" "A6070" "A6093" "A6098" "A6114" "A6118" "A6130" "A6136" "A6154" "A6162" "A6188" "A6195" "A6196" "A6231" "A6249" "A6252" "A6253" "A6258" "A6269" "A6274" "A6284" "A6286" "A6298" "A6304" "A6306" "A6307" "A6309" "A6314" "A6318" "A6323" "A6330" "A6331" "A6347" "A6351" "A6358" "A6363" "A6371" "A6380" "A6390" "A6415" "A6434" "A6437" "A6447" "A6464" "A6466" "A6467" "A6476" "A6478" "A6491" "A6501" "A6504" "A6506" "A6507" "A6521" "A6528" "A6535" "A6536" "A6541" "A6542" "A6549" "A6557" "A6559" "A6560" "A6565" "A6568" "A6569" "A6573" "A6580" "A6585" "A6590" "A6604" "A6606" "A6612" "A6617" "A6621" "A6623" "A6624" "A6643" "A6678" "A6681" "A6697" "A6699" "A6702" "A6709" "A6712" "A6716" "A6734" "A6735" "A6772" "A6780" "A6782" "A6789" "A6801" "A6806" "A6809" "A6821" "A6824" "A6832" "A6845" "A6846" "A6853" "A6870"];
archivos_norm = dir('Data/1 NSR/*.mat');
% Clase 2
archivos_fib = ["A0003" "A0004" "A0007" "A0009" "A0017" "A0019" "A0023" "A0026" "A0061" "A0064" "A0065" "A0071" "A0086" "A0101" "A0109" "A0117" "A0121" "A0122" "A0126" "A0145" "A0150" "A0153" "A0184" "A0186" "A0198" "A0203" "A0205" "A0217" "A0220" "A0222" "A0231" "A0235" "A0247" "A0257" "A0260" "A0267" "A0271" "A0272" "A0274" "A0276" "A0279" "A0290" "A0306" "A0316" "A0317" "A0331" "A0351" "A0358" "A0363" "A0370" "A0374" "A0375" "A0376" "A0383" "A0384" "A0390" "A0392" "A0405" "A0412" "A0415" "A0421" "A0424" "A0435" "A0442" "A0446" "A0456" "A0464" "A0468" "A0470" "A0471" "A0478" "A0483" "A0484" "A0491" "A0495" "A0498" "A0502" "A0504" "A0513" "A0514" "A0518" "A0519" "A0525" "A0530" "A0531" "A0537" "A0543" "A0545" "A0547" "A0549" "A0564" "A0566" "A0584" "A0586" "A0595" "A0598" "A0601" "A0609" "A0613" "A0629" "A0635" "A0639" "A0643" "A0646" "A0656" "A0663" "A0664" "A0672" "A0684" "A0686" "A0689" "A0693" "A0695" "A0699" "A0700" "A0701" "A0706" "A0707" "A0710" "A0713" "A0719" "A0731" "A0737" "A0745" "A0751" "A0763" "A0769" "A0773" "A0782" "A0788" "A0795" "A0799" "A0804" "A0833" "A0835" "A0836" "A0840" "A0848" "A0849" "A0850" "A0862" "A0887" "A0889" "A0890" "A0898" "A0907" "A0912" "A0923" "A0925" "A0927" "A0931" "A0932" "A0933" "A0941" "A0948" "A0963" "A0964" "A0979" "A0989" "A0993" "A0994" "A0995" "A1002" "A1007" "A1008" "A1010" "A1016" "A1017" "A1019" "A1022" "A1025" "A1027" "A1030" "A1044" "A1053" "A1054" "A1066" "A1070" "A1072" "A1076" "A1085" "A1093" "A1094" "A1098" "A1124" "A1136" "A1142" "A1149" "A1154" "A1155" "A1156" "A1158" "A1159" "A1163" "A1165" "A1180" "A1181" "A1182" "A1183" "A1184" "A1199" "A1201" "A1215" "A1216" "A1219" "A1224" "A1232" "A1233" "A1238" "A1249" "A1252" "A1255" "A1260" "A1287" "A1291" "A1292" "A1297" "A1299" "A1315" "A1317" "A1323" "A1324" "A1329" "A1366" "A1371" "A1374" "A1377" "A1389" "A1391" "A1397" "A1409" "A1411" "A1418" "A1423" "A1424" "A1427" "A1432" "A1458" "A1468" "A1472" "A1482" "A1485" "A1504" "A1514" "A1524" "A1526" "A1528" "A1538" "A1562" "A1575" "A1578" "A1583" "A1589" "A1598" "A1601" "A1603" "A1604" "A1605" "A1606" "A1607" "A1608" "A1612" "A1620" "A1624" "A1626" "A1635" "A1648" "A1653" "A1656" "A1661" "A1665" "A1684" "A1694" "A1712" "A1713" "A1718" "A1720" "A1725" "A1729" "A1732" "A1753" "A1757" "A1761" "A1762" "A1764" "A1765" "A1777" "A1781" "A1789" "A1792" "A1797" "A1803" "A1817" "A1842" "A1852" "A1856" "A1867" "A1875" "A1882" "A1887" "A1889" "A1895" "A1902" "A1917" "A1927" "A1931" "A1932" "A1933" "A1941" "A1948" "A1950" "A1953" "A1957" "A1958" "A1965" "A1968" "A1973" "A1977" "A1978" "A2009" "A2016" "A2019" "A2027" "A2028" "A2031" "A2064" "A2066" "A2081" "A2084" "A2093" "A2100" "A2105" "A2109" "A2111" "A2118" "A2148" "A2150" "A2157" "A2158" "A2159" "A2169" "A2176" "A2180" "A2193" "A2211" "A2221" "A2223" "A2230" "A2237" "A2241" "A2249" "A2256" "A2278" "A2284" "A2289" "A2297" "A2300" "A2310" "A2332" "A2336" "A2339" "A2344" "A2348" "A2357" "A2373" "A2375" "A2378" "A2385" "A2389" "A2406" "A2407" "A2409" "A2429" "A2438" "A2446" "A2455" "A2459" "A2463" "A2472" "A2479" "A2482" "A2511" "A2515" "A2517" "A2522" "A2527" "A2529" "A2534" "A2535" "A2539" "A2548" "A2551" "A2563" "A2565" "A2573" "A2590" "A2594" "A2595" "A2610" "A2611" "A2612" "A2613" "A2618" "A2627" "A2639" "A2640" "A2641" "A2642" "A2643" "A2644" "A2645" "A2647" "A2659" "A2672" "A2682" "A2691" "A2692" "A2696" "A2697" "A2703" "A2704" "A2706" "A2712" "A2714" "A2715" "A2716" "A2718" "A2725" "A2733" "A2756" "A2757" "A2759" "A2763" "A2764" "A2775" "A2783" "A2791" "A2794" "A2821" "A2833" "A2839" "A2845" "A2848" "A2849" "A2850" "A2852" "A2857" "A2863" "A2876" "A2880" "A2882" "A2885" "A2887" "A2899" "A2902" "A2903" "A2929" "A2936" "A2939" "A2947" "A2952" "A2960" "A2962" "A2964" "A2967" "A2975" "A2978" "A2985" "A2987" "A2992" "A3001" "A3024" "A3032" "A3039" "A3047" "A3048" "A3049" "A3064" "A3075" "A3079" "A3084" "A3088" "A3094" "A3098" "A3107" "A3112" "A3115" "A3127" "A3140" "A3143" "A3144" "A3148" "A3158" "A3169" "A3171" "A3177" "A3180" "A3182" "A3183" "A3189" "A3192" "A3198" "A3209" "A3212" "A3213" "A3223" "A3254" "A3259" "A3277" "A3279" "A3280" "A3282" "A3289" "A3294" "A3303" "A3308" "A3309" "A3315" "A3316" "A3317" "A3320" "A3321" "A3330" "A3333" "A3339" "A3343" "A3367" "A3379" "A3387" "A3397" "A3398" "A3401" "A3402" "A3403" "A3405" "A3418" "A3425" "A3432" "A3433" "A3437" "A3456" "A3460" "A3476" "A3483" "A3484" "A3496" "A3504" "A3507" "A3509" "A3510" "A3517" "A3536" "A3537" "A3543" "A3545" "A3563" "A3567" "A3570" "A3589" "A3597" "A3615" "A3622" "A3626" "A3627" "A3641" "A3644" "A3649" "A3659" "A3664" "A3666" "A3669" "A3676" "A3677" "A3679" "A3681" "A3685" "A3701" "A3702" "A3709" "A3715" "A3726" "A3731" "A3734" "A3737" "A3752" "A3753" "A3754" "A3755" "A3760" "A3763" "A3764" "A3773" "A3780" "A3786" "A3787" "A3798" "A3808" "A3830" "A3835" "A3840" "A3849" "A3855" "A3861" "A3876" "A3881" "A3888" "A3917" "A3927" "A3940" "A3949" "A3951" "A3955" "A3969" "A3985" "A3995" "A4005" "A4009" "A4012" "A4016" "A4035" "A4037" "A4041" "A4043" "A4053" "A4062" "A4073" "A4075" "A4094" "A4101" "A4105" "A4106" "A4107" "A4108" "A4110" "A4123" "A4129" "A4132" "A4137" "A4139" "A4152" "A4158" "A4159" "A4162" "A4166" "A4171" "A4177" "A4178" "A4183" "A4193" "A4194" "A4205" "A4214" "A4223" "A4226" "A4229" "A4230" "A4238" "A4248" "A4254" "A4261" "A4279" "A4281" "A4301" "A4313" "A4331" "A4335" "A4339" "A4341" "A4344" "A4345" "A4347" "A4350" "A4354" "A4356" "A4361" "A4365" "A4372" "A4409" "A4417" "A4421" "A4458" "A4459" "A4461" "A4476" "A4490" "A4496" "A4502" "A4505" "A4510" "A4511" "A4522" "A4527" "A4544" "A4551" "A4554" "A4559" "A4560" "A4561" "A4566" "A4568" "A4584" "A4586" "A4587" "A4591" "A4594" "A4615" "A4624" "A4636" "A4642" "A4663" "A4682" "A4691" "A4696" "A4703" "A4709" "A4718" "A4720" "A4721" "A4724" "A4725" "A4727" "A4730" "A4732" "A4762" "A4777" "A4779" "A4788" "A4796" "A4805" "A4814" "A4816" "A4817" "A4821" "A4824" "A4829" "A4834" "A4836" "A4838" "A4839" "A4855" "A4860" "A4874" "A4889" "A4892" "A4905" "A4915" "A4919" "A4928" "A4932" "A4933" "A4950" "A4972" "A4974" "A4980" "A4990" "A4997" "A4998" "A5000" "A5010" "A5020" "A5023" "A5029" "A5041" "A5049" "A5054" "A5073" "A5078" "A5083" "A5084" "A5089" "A5093" "A5098" "A5101" "A5107" "A5117" "A5128" "A5138" "A5139" "A5141" "A5146" "A5156" "A5159" "A5166" "A5170" "A5181" "A5187" "A5190" "A5195" "A5208" "A5220" "A5225" "A5240" "A5252" "A5261" "A5267" "A5273" "A5275" "A5284" "A5300" "A5308" "A5320" "A5325" "A5339" "A5343" "A5353" "A5356" "A5362" "A5376" "A5377" "A5380" "A5382" "A5384" "A5388" "A5396" "A5397" "A5398" "A5400" "A5401" "A5404" "A5406" "A5416" "A5418" "A5421" "A5433" "A5436" "A5438" "A5442" "A5443" "A5445" "A5454" "A5467" "A5469" "A5496" "A5502" "A5508" "A5511" "A5521" "A5526" "A5529" "A5531" "A5533" "A5534" "A5545" "A5557" "A5559" "A5561" "A5571" "A5584" "A5587" "A5589" "A5592" "A5595" "A5607" "A5613" "A5622" "A5624" "A5626" "A5627" "A5629" "A5630" "A5634" "A5637" "A5645" "A5649" "A5651" "A5652" "A5655" "A5658" "A5666" "A5668" "A5674" "A5676" "A5677" "A5679" "A5685" "A5701" "A5703" "A5717" "A5718" "A5724" "A5725" "A5730" "A5745" "A5746" "A5754" "A5757" "A5760" "A5764" "A5772" "A5775" "A5780" "A5783" "A5784" "A5787" "A5790" "A5791" "A5795" "A5805" "A5815" "A5820" "A5823" "A5829" "A5834" "A5837" "A5842" "A5846" "A5848" "A5854" "A5857" "A5867" "A5872" "A5874" "A5878" "A5884" "A5893" "A5897" "A5909" "A5912" "A5914" "A5915" "A5929" "A5958" "A5960" "A5964" "A5969" "A5971" "A5989" "A5995" "A6013" "A6022" "A6037" "A6039" "A6043" "A6044" "A6047" "A6059" "A6060" "A6061" "A6068" "A6092" "A6097" "A6123" "A6126" "A6127" "A6131" "A6135" "A6146" "A6149" "A6152" "A6164" "A6165" "A6170" "A6172" "A6174" "A6177" "A6186" "A6194" "A6210" "A6215" "A6219" "A6222" "A6223" "A6225" "A6226" "A6227" "A6236" "A6245" "A6250" "A6257" "A6266" "A6277" "A6282" "A6288" "A6290" "A6294" "A6295" "A6300" "A6302" "A6317" "A6326" "A6334" "A6335" "A6352" "A6368" "A6369" "A6381" "A6384" "A6387" "A6393" "A6397" "A6398" "A6416" "A6417" "A6422" "A6428" "A6429" "A6435" "A6444" "A6450" "A6456" "A6487" "A6488" "A6496" "A6503" "A6508" "A6517" "A6520" "A6539" "A6546" "A6551" "A6567" "A6571" "A6578" "A6584" "A6588" "A6592" "A6597" "A6598" "A6602" "A6605" "A6609" "A6611" "A6614" "A6629" "A6665" "A6671" "A6675" "A6676" "A6685" "A6688" "A6694" "A6695" "A6698" "A6706" "A6710" "A6713" "A6721" "A6724" "A6728" "A6736" "A6738" "A6741" "A6743" "A6746" "A6755" "A6764" "A6777" "A6781" "A6788" "A6790" "A6798" "A6803" "A6815" "A6835" "A6837" "A6838" "A6850" "A6851" "A6861" "A6862" "A6863" "A6867" "A6869" "A6876"];
archivos_fib = dir('Data/4 AFIB/*.mat');

% arch_norm = randsample(archivos_norm,1)
% arch_fib = randsample(archivos_fib,1)
arch_norm = "106m (1)";
arch_fib = "101m (1)";

norm = load(arch_norm);
fib = load(arch_fib);

% imf_norm = emd(norm.ECG.data(2,:));
% imf_fib = emd(fib.ECG.data(2,:));
imf_norm = emd(norm.val);
imf_fib = emd(fib.val);

% imf_mean_norm = emd(mean(norm.ECG.data));
% imf_mean_fib = emd(mean(fib.ECG.data));

fs = 360;

[P_norm,f_norm,t_norm] = hht(imf_norm,fs,'FrequencyLimits',[0 3]);
[P_fib,f_fib,t_fib] = hht(imf_fib,fs,'FrequencyLimits',[0 3]);
full_P_norm = full(P_norm);
maximum_norm = max(max(full_P_norm))
[x_norm,y_norm]=find(full_P_norm==maximum_norm)
full_P_fib = full(P_fib);
maximum_fib = max(max(full_P_fib))
[x_fib,y_fib]=find(full_P_fib==maximum_fib)

[maxEnergy, linearIdx] = max(P_norm(:));             % Max value and linear index
[row, col] = ind2sub(size(P_norm), linearIdx);
freqAtMax = f_norm(row);
timeAtMax = t_norm(col);

fprintf('Max Instantaneous Energy:');
maxEnergy
fprintf('Occurs at Time:');
timeAtMax
fprintf('Occurs at Frequency:');
freqAtMax

figure(1)
imagesc(t_norm, f_norm, P_norm);
xlabel('Time (s)');
ylabel('Frequency (Hz)');
title('Hilbert Spectrum (Energy)');
colorbar;
hold on;
plot(timeAtMax, freqAtMax, 'rx', 'MarkerSize', 12, 'LineWidth', 2);
hold off;

figure(2)
mesh(seconds(t_norm),f_norm,P_norm,'EdgeColor','none','FaceColor','interp')
xlabel('Time (s)')
ylabel('Frequency (Hz)')
zlabel('Instantaneous Energy')



%mean_norm = mean(P_norm(:,2))
%std_norm = std(P_norm(:,2))

%mean_fib = mean(P_fib(:,2))
%std_fib = std(P_fib(:,2))

%P_norm_mean = hht(imf_mean_norm,100);
%P_fib_mean = hht(imf_mean_fib,100);